<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    function calculate() {
      var inputValues = document.querySelectorAll('.input-value');
      var weights = document.querySelectorAll('.weight');
      var result = document.getElementById('result');
      
      if (inputValues.length !== weights.length) {
        throw new Error("Input fields must have the same length.");
      }
      
      var sum = 0;
      var weightSum = 0;
      
      for (var i = 0; i < inputValues.length; i++) {
        var inputValue = parseFloat(inputValues[i].value);
        var weight = parseFloat(weights[i].value);
      
        if (isNaN(inputValue) || isNaN(weight)) {
          result.textContent = "Invalid input";
          return;
        }
      
        sum += inputValue * weight;
        weightSum += weight;
      }
      
      var weightedAverage = sum / weightSum;
      result.textContent = weightedAverage.toFixed(2);
    }

    function addRow() {
      var tbody = document.querySelector('tbody');
      var tr = document.createElement('tr');

      var tdInput = document.createElement('td');
      var input = document.createElement('input');
      input.type = 'number';
      input.classList.add('input-value');
      tdInput.appendChild(input);

      var tdWeight = document.createElement('td');
      var weight = document.createElement('input');
      weight.type = 'number';
      weight.classList.add('weight');
      tdWeight.appendChild(weight);

      var tdResult = document.createElement('td');
      var result = document.createElement('span');
      result.classList.add('result');
      tdResult.appendChild(result);

      tr.appendChild(tdInput);
      tr.appendChild(tdWeight);
      tr.appendChild(tdResult);

      tbody.appendChild(tr);
    }

    function DeleteRow() {
        var tbody = document.querySelector('tbody');
        var rowCount = tbody.rows.length;
      
        if (rowCount > 1) {
          tbody.deleteRow(rowCount - 1);
        }
      }
      
  </script>
  <title>Document</title>
</head>
<body>
  <table>
    <thead>
      <tr>
        <th>Input Value</th>
        <th>Weight</th>
        <th>Result</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input type="number" class="input-value"></td>
        <td><input type="number" class="weight"></td>
        <td><span class="result"></span></td>
      </tr>
      <tr>
        <td><input type="number" class="input-value"></td>
        <td><input type="number" class="weight"></td>
        <td><span class="result"></span></td>
      </tr>
      <tr>
        <td><input type="number" class="input-value"></td>
        <td><input type="number" class="weight"></td>
        <td><span class="result"></span></td>
      </tr>
    </tbody>
  </table>

  <button onclick="calculate()">Calculate Weighted Average</button>
  <button onclick="addRow()">Add Row</button>
  <button onclick="DeleteRow()">Delete Row</button>
  <span id="result"></span>
</body>
</html>
